http:
  routers:
    nginx:
      # Route test traffic via Traefik at 192.168.1.72 using a path prefix.
      rule: "Host(`nginx.easontm.com`)"
      entryPoints:
        - websecure
      service: nginx
      middlewares:
        - authelia
        - secure-headers
        - strip-nginx-prefix
      tls: {}
    authelia:
      rule: "Host(`auth.easontm.com`)"
      service: authelia
      entryPoints:
        - websecure
      tls: {}

  middlewares:
    authelia:
      forwardAuth:
        # Forward-Auth endpoint provided by Authelia.
        # <AUTHELIA_URL>
        # address: 'https://auth.easontm.com/api/authz/forward-auth'
        address: 'http://192.168.1.75:9091/api/authz/forward-auth'
        trustForwardHeader: true
        authResponseHeaders:
          - 'Remote-User'
          - 'Remote-Groups'
          - 'Remote-Email'
          - 'Remote-Name'

    secure-headers:
      headers:
        sslRedirect: true
        stsSeconds: 31536000
        stsIncludeSubdomains: true
        stsPreload: true
        contentTypeNosniff: true
        browserXssFilter: true
        referrerPolicy: "no-referrer"
        permissionsPolicy: "geolocation=()"
        customResponseHeaders:
          X-Frame-Options: "DENY"
          X-Content-Type-Options: "nosniff"
          X-XSS-Protection: "1; mode=block"
          Cache-Control: "no-store"

    strip-nginx-prefix:
      stripPrefix:
        prefixes:
          - /nginx

  services:
    nginx:
      loadBalancer:
        servers:
          - url: "http://192.168.1.73:80"
    authelia:
      loadBalancer:
        servers:
          - url: "http://192.168.1.75:9091"